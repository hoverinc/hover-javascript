version: '1.0'

stages:
  - prepare
  - build
  - release

steps:
  clone:
    stage: prepare
    type: 'git-clone'
    repo: '${{CF_REPO_OWNER}}/${{CF_REPO_NAME}}'
    revision: '${{CF_BRANCH}}'
  build:
    stage: build
    image: node:10.16.0-alpine
    commands:
      - yarn install
  test:
    stage: build
    image: node:10.16.0-alpine
    commands:
      - yarn validate
  release:
    stage: release
    image: node:10.16.0-alpine
    commands:
      - yarn build
      - node src travis-after-success
